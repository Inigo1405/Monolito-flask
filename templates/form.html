{% extends 'index.html'%}
 
{% block contenido %}
<div class="container">
    <div class="col-md-12 row">
        <h2>{{subtitulo}}</h2>
    </div>
    
    <!-- Mensajes Flash -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}
    
    <div class="row">
        <div class="col-md-6">
            {% if producto %}
                <form method="post" action="/productos/editar/{{ producto['id'] }}">
            {% else %}
                <form method="post" action="/productos/nuevo">
            {% endif %}
                
                <div class="form-group">
                    <label for="name_prod">Nombre del Producto *</label>
                    <input type="text" class="form-control" id="name_prod" name="name_prod" 
                           placeholder="Ingrese el nombre del producto"
                           value="{% if form_data %}{{ form_data.name_prod }}{% elif producto %}{{ producto['name_prod'] }}{% endif %}"
                           required>
                </div>
                
                <div class="form-group">
                    <label for="price">Precio *</label>
                    <input type="number" step="0.01" min="0" class="form-control" id="price" name="price" 
                           placeholder="0.00"
                           value="{% if form_data %}{{ form_data.price }}{% elif producto %}{{ producto['price'] if producto['price'] else 0 }}{% else %}0{% endif %}"
                           required>
                    <small class="form-text text-muted">Debe ser mayor o igual a 0.</small>
                </div>
                
                <div class="form-group">
                    <label for="stock">Stock *</label>
                          <input type="number" min="0" class="form-control" id="stock" name="stock" 
                              placeholder="0"
                              value="{% if form_data %}{{ form_data.stock|int }}{% elif producto %}{{ producto['stock']|int if producto['stock'] else 0 }}{% else %}0{% endif %}"
                              required>
                    <small class="form-text text-muted">Debe ser mayor o igual a 0.</small>
                </div>

                <div class="form-group">
                    <label for="categoria">Categoria del Producto *</label>
                    <input type="text" class="form-control" id="categoria" name="categoria" 
                           placeholder="Ingrese la categorÃ­a del producto"
                           value="{% if form_data %}{{ form_data.categoria }}{% elif producto %}{{ producto['categoria'] }}{% endif %}"
                           required>
                </div>
                
                <div class="form-group form-check">
                    <input type="checkbox" class="form-check-input" id="active" name="active"
                           {% if form_data and form_data.active %}checked{% elif producto and producto['active'] %}checked{% elif not producto and not form_data %}checked{% endif %}>
                    <label class="form-check-label" for="active">Producto Activo</label>
                </div>
                
                <div class="form-group">
                    <button type="submit" class="btn btn-primary">
                        {% if producto %}Actualizar{% else %}Crear{% endif %} Producto
                    </button>
                    <a href="/productos" class="btn btn-secondary">Cancelar</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}